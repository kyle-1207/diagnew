# é”‚ç”µæ± æ•…éšœæ£€æµ‹ - Linuxç¯å¢ƒç‰ˆæœ¬

## ğŸ“‹ é¡¹ç›®ç®€ä»‹
åŸºäºTransformerå’ŒMC-AEçš„é”‚ç”µæ± æ•…éšœæ£€æµ‹ç³»ç»Ÿï¼Œé’ˆå¯¹LinuxæœåŠ¡å™¨ç¯å¢ƒä¼˜åŒ–ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå®‰è£…
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x *.sh

# è¿è¡Œå®‰è£…è„šæœ¬
./install_env.sh

# æ£€æŸ¥ç¯å¢ƒé…ç½®
./check_environment.sh
```

### 2. æ•°æ®å‡†å¤‡
ç¡®ä¿æ•°æ®æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼ˆQASä¸diagnosisç›®å½•åŒçº§ï¼‰ï¼š
```
../QAS/
â”œâ”€â”€ Labels.xls                    # æ ·æœ¬æ ‡ç­¾æ–‡ä»¶
â”œâ”€â”€ 0/
â”‚   â”œâ”€â”€ vin_1.pkl
â”‚   â”œâ”€â”€ vin_2.pkl
â”‚   â”œâ”€â”€ vin_3.pkl
â”‚   â””â”€â”€ targets.pkl (è®­ç»ƒåç”Ÿæˆ)
â”œâ”€â”€ 1/
â”‚   â”œâ”€â”€ vin_1.pkl
â”‚   â”œâ”€â”€ vin_2.pkl
â”‚   â”œâ”€â”€ vin_3.pkl
â”‚   â””â”€â”€ targets.pkl (è®­ç»ƒåç”Ÿæˆ)
â””â”€â”€ ... (0-392æ ·æœ¬)
```

**æ ·æœ¬åˆ†é…**:
- **è®­ç»ƒæ ·æœ¬**: 0-200 (201ä¸ªæ ·æœ¬)
- **æµ‹è¯•æ­£å¸¸æ ·æœ¬**: 201-334 (134ä¸ªæ ·æœ¬)
- **æµ‹è¯•æ•…éšœæ ·æœ¬**: 335-392 (58ä¸ªæ ·æœ¬)

### 3. è¿è¡Œæµç¨‹

#### æ–¹å¼ä¸€ï¼šä¸€é”®è¿è¡Œå®Œæ•´æµç¨‹
```bash
chmod +x run_training.sh
./run_training.sh
```

#### æ–¹å¼äºŒï¼šåˆ†æ­¥è¿è¡Œ
```bash
# ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆè®­ç»ƒæ ·æœ¬çš„targets.pkl
python3 precompute_targets.py

# ç¬¬ä¸€æ­¥è¡¥å……ï¼šç”Ÿæˆæµ‹è¯•æ ·æœ¬çš„targets.pkl
python3 precompute_targets_test.py

# ç¬¬äºŒæ­¥ï¼šè®­ç»ƒBiLSTMåŸºå‡†æ¨¡å‹
python3 Train_BILSTM.py

# ç¬¬ä¸‰æ­¥ï¼šè®­ç»ƒTransformeræ¨¡å‹
python3 Train_Transformer.py

# ç¬¬å››æ­¥ï¼šæ€§èƒ½æµ‹è¯•
python3 Test_combine.py
```

## ğŸ“ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒè„šæœ¬
- `precompute_targets.py` - é¢„è®¡ç®—è®­ç»ƒæ ·æœ¬çœŸå®å€¼æ•°æ®
- `precompute_targets_test.py` - é¢„è®¡ç®—æµ‹è¯•æ ·æœ¬çœŸå®å€¼æ•°æ®
- `Train_Transformer.py` - ä¸»è®­ç»ƒè„šæœ¬
- `data_loader_transformer.py` - æ•°æ®åŠ è½½å™¨
- `Test_combine.py` - æ€§èƒ½æµ‹è¯•è„šæœ¬

### å·¥å…·ç±»
- `Function_.py` - æ ¸å¿ƒå‡½æ•°åº“
- `Class_.py` - æ¨¡å‹ç±»å®šä¹‰
- `create_dataset.py` - æ•°æ®é›†å·¥å…·

### é…ç½®æ–‡ä»¶
- `requirements.txt` - ä¾èµ–åŒ…åˆ—è¡¨
- `install_env.sh` - ç¯å¢ƒå®‰è£…è„šæœ¬
- `check_environment.sh` - ç¯å¢ƒæ£€æŸ¥è„šæœ¬
- `run_training.sh` - ä¸€é”®è®­ç»ƒè„šæœ¬

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- Python 3.8+
- CUDA 12.3+ (æ”¯æŒA100 GPU)
- å†…å­˜: 32GB+ (æ¨è)
- å­˜å‚¨: 50GB+ (ç”¨äºæ•°æ®æ–‡ä»¶)
- æ•°æ®è·¯å¾„: `../QAS/` (ä¸diagnosisç›®å½•åŒçº§)

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### GPUè®­ç»ƒ
```bash
# æ£€æŸ¥GPUçŠ¶æ€
nvidia-smi

# è®¾ç½®GPUè®¾å¤‡
export CUDA_VISIBLE_DEVICES=0
```

### å†…å­˜ä¼˜åŒ–
```bash
# å¦‚æœå†…å­˜ä¸è¶³ï¼Œå¯ä»¥è°ƒæ•´batch_size
# åœ¨Train_Transformer.pyä¸­ä¿®æ”¹BATCH_SIZEå‚æ•°
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. å­—ä½“æ˜¾ç¤ºé—®é¢˜
Linuxç¯å¢ƒå¯èƒ½ç¼ºå°‘ä¸­æ–‡å­—ä½“ï¼Œå·²è‡ªåŠ¨é…ç½®ä¸ºä½¿ç”¨ç³»ç»Ÿå­—ä½“ã€‚

### 2. CUDAç‰ˆæœ¬ä¸åŒ¹é…
```bash
# é‡æ–°å®‰è£…åŒ¹é…çš„PyTorchç‰ˆæœ¬
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

### 3. æƒé™é—®é¢˜
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x *.sh
chmod +x *.py
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ
å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Pythonç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚
2. ä¾èµ–åŒ…æ˜¯å¦æ­£ç¡®å®‰è£…
3. æ•°æ®æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
4. GPUé©±åŠ¨æ˜¯å¦æ­£å¸¸ 